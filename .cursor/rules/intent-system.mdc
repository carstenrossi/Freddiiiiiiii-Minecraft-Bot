---
description: Guide for adding new features to Freddiiiiii's Intent System
globs: bot-advanced.js
alwaysApply: false
---

# Intent-System Guide fÃ¼r Eddie

Diese Rule hilft Eddie dabei, neue Features zu Freddiiiiii hinzuzufÃ¼gen.

**WICHTIG:** Die Hauptdatei ist `bot-advanced.js` (NICHT bot-intent.js!)

## ğŸ¯ Struktur von bot-advanced.js

```
bot-advanced.js (~2490 Zeilen)
â”‚
â”œâ”€ ğŸ“¦ IMPORTS (Zeile 1-12)
â”‚  â””â”€ mineflayer, pathfinder, ollama, spatial-intelligence, template-system
â”‚
â”œâ”€ âš™ï¸ CONFIG (Zeile 14-35)
â”‚  â””â”€ Bot-Einstellungen, Ollama-Verbindung, Template-System Init
â”‚
â”œâ”€ ğŸ” UMGEBUNGS-SCANNER (Zeile 120-365)
â”‚  â””â”€ scanneUmgebung() - Scannt Wasser, BÃ¤ume, Entities
â”‚  â””â”€ formatiereUmgebungsInfo() - Formatiert Scan fÃ¼r Chat
â”‚
â”œâ”€ ğŸ§  LLM PLANNER (Zeile 400-580)
â”‚  â””â”€ planeAktionen() - Hauptfunktion fÃ¼r Intent-Erkennung!
â”‚  â””â”€ Sendet Anfrage + Umgebung ans LLM, bekommt JSON zurÃ¼ck
â”‚
â”œâ”€ âš¡ INTENT EXECUTOR (Zeile 583-875)
â”‚  â””â”€ fuehreIntentAus() - GroÃŸer switch-case fÃ¼r alle Intents
â”‚  â””â”€ HIER NEUE INTENT-CASES HINZUFÃœGEN!
â”‚
â”œâ”€ ğŸ¬ ACTION FUNCTIONS (Zeile 1010-2380)
â”‚  â””â”€ HIER FÃœGT EDDIE NEUE FEATURES HINZU!
â”‚  â””â”€ geheZuPosition(), grabeBereich(), sammleHolz(), baueStruktur()
â”‚  â””â”€ baueFarm(), baueTemplate(), greifeMobAn(), smartEscape(), etc.
â”‚
â””â”€ ğŸ® CHAT EVENT (Zeile 2385-2490)
   â””â”€ Aktivierungs-System ("Freddi, baue...")
   â””â”€ Ruft chatMitLLM() auf
```

## âœ¨ Wie du neue Features hinzufÃ¼gst

### Schritt 1: Action Function erstellen

FÃ¼ge eine neue Funktion im **Action Functions Bereich** hinzu (ca. Zeile 1010-2380 in bot-advanced.js):

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¯ FEATURE: [Dein Feature Name]
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Was es macht: [Kurze Beschreibung]
// Befehl: "[Beispiel-Befehl]"
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function deinFeatureName(parameter1, parameter2) {
  try {
    // Gib Feedback dass es startet
    bot.chat(`ğŸ¯ [Dein Feature] startet...`);
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // DEIN CODE HIER
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    // [Logik des Features]
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Erfolgs-Meldung
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    bot.chat(`âœ… [Dein Feature] fertig!`);
    
    return { success: true, message: "Feature erfolgreich" };
    
  } catch (error) {
    // Wenn was schief geht
    console.error(`âŒ Fehler in [Feature]:`, error);
    bot.chat(`âŒ Fehler: ${error.message}`);
    return { success: false, message: error.message };
  }
}
```

### Schritt 2: Intent-Case hinzufÃ¼gen

In der `fuehreIntentAus()` Funktion (ca. Zeile 583), fÃ¼ge einen neuen case hinzu:

```javascript
switch (intent.type) {
  // ... bestehende cases ...
  
  case 'dein_intent_name':
    // ErklÃ¤re was dieser Intent macht
    // Parameter aus intent.params holen
    const param1 = intent.params?.parameter1 || 'default';
    const param2 = intent.params?.parameter2 || 'default';
    
    // Action-Funktion aufrufen
    return await deinFeatureName(param1, param2);
  
  // ... weitere cases ...
}
```

## ğŸ“‹ Template fÃ¼r neue Features

Kopiere dieses Template und fÃ¼lle es aus:

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¯ FEATURE: [Name]
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Was es macht: [Beschreibung]
// Befehl: "[Beispiel]"
// Parameter: [Welche Parameter? Optional/Pflicht?]
// Beispiele:
//   - "[Beispiel 1]"
//   - "[Beispiel 2]"
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function featureName(params) {
  try {
    // 1. Start-Feedback
    bot.chat(`ğŸ¯ [Feature] wird ausgefÃ¼hrt...`);
    
    // 2. Validierung (falls nÃ¶tig)
    if (!params) {
      bot.chat('âŒ Parameter fehlt!');
      return { success: false, message: 'Parameter fehlt' };
    }
    
    // 3. Haupt-Logik
    // [DEIN CODE HIER]
    
    // 4. Erfolgs-Feedback
    bot.chat(`âœ… Fertig!`);
    return { success: true };
    
  } catch (error) {
    // 5. Fehlerbehandlung
    console.error('âŒ Fehler:', error);
    bot.chat(`âŒ Fehler: ${error.message}`);
    return { success: false, message: error.message };
  }
}
```

## ğŸ® Beispiel-Feature: "Dance"

So wÃ¼rde ein "dance" Feature aussehen:

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¯ FEATURE: Tanz-Animation
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Was es macht: Bot springt mehrfach
// Befehl: "dance" oder "dance 5"
// Parameter: anzahl (optional, default: 3)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function performDance(anzahl = 3) {
  try {
    bot.chat(`ğŸ’ƒ Lass uns tanzen!`);
    
    // Springe mehrfach
    for (let i = 0; i < anzahl; i++) {
      bot.setControlState('jump', true);   // Springe
      await sleep(500);                     // Warte 0.5s
      bot.setControlState('jump', false);  // Lande
      await sleep(300);                     // Kurze Pause
    }
    
    bot.chat(`âœ… ${anzahl} SprÃ¼nge! ğŸ‰`);
    return { success: true };
    
  } catch (error) {
    console.error('âŒ Tanz-Fehler:', error);
    return { success: false, message: error.message };
  }
}

// Dann in parseAndExecuteIntent():
case 'tanze':
  const anzahl = intent.params?.anzahl || 3;
  return await performDance(anzahl);
```

## ğŸ”§ Wichtige Bot-Funktionen

Hier sind die wichtigsten Funktionen die du nutzen kannst:

### Kommunikation
```javascript
bot.chat("Nachricht");              // Schreibt in Chat
console.log("Log-Nachricht");       // Schreibt in Konsole
```

### Bewegung
```javascript
await bot.pathfinder.goto(goal);    // Gehe zu Ziel
bot.setControlState('jump', true);  // Springe
bot.setControlState('forward', true); // Laufe vorwÃ¤rts
bot.setControlState('sprint', true);  // Sprinte
```

### BlÃ¶cke
```javascript
const block = bot.blockAt(position); // Hole Block an Position
await bot.dig(block);                // Grabe Block ab
await bot.placeBlock(block, face);   // Platziere Block
bot.findBlocks({...});               // Finde BlÃ¶cke in Umgebung
```

### Inventar
```javascript
bot.inventory.items();               // Alle Items im Inventar
await bot.equip(item, 'hand');       // Item in Hand nehmen
```

### Entities
```javascript
Object.values(bot.entities);         // Alle Entities
bot.nearestEntity(filter);           // NÃ¤chste Entity finden
```

### Position
```javascript
bot.entity.position;                 // Aktuelle Position
position.offset(x, y, z);            // Neue Position berechnen
position.distanceTo(other);          // Distanz berechnen
```

## âš¡ HÃ¤ufige Muster

### Pattern 1: Zu Position gehen
```javascript
const goal = new goals.GoalNear(x, y, z, 1);
await bot.pathfinder.goto(goal);
```

### Pattern 2: NÃ¤chstes X finden und hingehen
```javascript
// Finde nÃ¤chstes Wasser
const wasserBlocks = bot.findBlocks({
  matching: (block) => block.name === 'water',
  maxDistance: 32,
  count: 1
});

if (wasserBlocks.length > 0) {
  const pos = wasserBlocks[0];
  const goal = new goals.GoalNear(pos.x, pos.y, pos.z, 1);
  await bot.pathfinder.goto(goal);
}
```

### Pattern 3: Mehrere BlÃ¶cke platzieren
```javascript
for (let x = 0; x < breite; x++) {
  for (let z = 0; z < laenge; z++) {
    const pos = startPos.offset(x, 0, z);
    // Platziere Block bei pos
    await sleep(100); // Kleine Pause
  }
}
```

### Pattern 4: Auf Event warten
```javascript
await sleep(millisekunden);  // Warte X Millisekunden
// Beispiel: await sleep(1000) = 1 Sekunde warten
```

## ğŸ› Debug-Tipps

### Logging hinzufÃ¼gen
```javascript
console.log('ğŸ” Debug:', variable);
console.log('ğŸ“ Position:', bot.entity.position);
```

### Try-Catch nutzen
```javascript
try {
  // Dein Code
} catch (error) {
  console.error('âŒ Fehler:', error);
  console.error('ğŸ“œ Stack:', error.stack);
}
```

### Bot-Feedback
```javascript
bot.chat(`Debug: ${JSON.stringify(daten)}`);
```

## âœ… Checkliste fÃ¼r neue Features

Wenn du ein Feature hinzufÃ¼gst, prÃ¼fe:

- [ ] Action-Funktion im richtigen Bereich eingefÃ¼gt?
- [ ] try-catch Block vorhanden?
- [ ] Start-Feedback (bot.chat beim Start)?
- [ ] Erfolgs-Feedback (bot.chat bei Erfolg)?
- [ ] Fehler-Handling (catch Block)?
- [ ] Intent-Case hinzugefÃ¼gt?
- [ ] Parameter richtig geholt (intent.params)?
- [ ] Kommentare die erklÃ¤ren was passiert?
- [ ] AusfÃ¼hrliche Header-Kommentar?

## ğŸ¯ Intent-Typen die bereits existieren (in fuehreIntentAus)

Schau dir diese in bot-advanced.js an als Beispiele:

**Bewegung:**
- `gehe_wasser` / `gehe_zu_wasser` - Bot geht zu Wasser
- `gehe_baum` / `gehe_zu_baum` - Bot geht zu BÃ¤umen
- `gehe_berg` / `gehe_hoch` - Bot geht zum hÃ¶chsten Punkt
- `komm_spieler` - Bot kommt zum Spieler
- `gehe_entity` / `gehe_tier` - Bot geht zu Entity (Tier/Mob)
- `gehe_xy` - Bot geht zu Koordinaten
- `tp_spieler` - Bot teleportiert zum Spieler

**Aktionen:**
- `graben` - Bot grÃ¤bt Bereich (Breite x Tiefe x LÃ¤nge)
- `sammle_holz` - Bot sammelt Holz
- `bauen` - Bot baut einfache Struktur (Turm, Wand)
- `baue_farm` - Bot baut komplette Weizen-Farm
- `baue_template` - Bot baut GebÃ¤ude nach JSON-Template

**Kampf:**
- `angriff` - Bot greift Mob an (mit Verfolgung!)

**Info:**
- `scan` - Bot scannt Umgebung (32m)
- `analyse` - Detaillierte Raumanalyse
- `position` - Zeigt Position
- `inventar` - Zeigt Inventar
- `schaue` / `drehe` - Bot dreht sich

**Sonstiges:**
- `escape` - Bot kommt aus Loch (Pillaring/Graben)
- `essen` - Bot isst Nahrung
- `craften` - Bot craftet Items
- `konversation` - Nur Chat, keine Aktion

**Tipp:** Suche nach `case 'angriff':` in bot-advanced.js um zu sehen wie das Intent-System funktioniert!

## ğŸš€ Von einfach zu komplex

### Einfach (Start hier!)
- Chat-Antworten
- SprÃ¼nge, Bewegungen
- Einfache BlÃ¶cke platzieren

### Mittel
- Zu Positionen/Entities navigieren
- Mehrere BlÃ¶cke platzieren
- Inventar-Aktionen

### Fortgeschritten
- Komplexe Bau-Strukturen
- Multi-Step Aktionen
- Intelligentes Verhalten

**Fang klein an und baue auf! Jedes Feature macht dich besser! ğŸ’ª**
